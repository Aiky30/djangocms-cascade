{% load static cms_js_tags sekizai_tags thumbnail l10n %}

{% addtoblock "css" %}<link href="{% static 'node_modules/leaflet/dist/leaflet.css' %}" rel="stylesheet" type="text/css" />{% endaddtoblock %}
{% addtoblock "js" %}<script src="{% static 'node_modules/leaflet/dist/leaflet.js' %}" type="text/javascript" />{% endaddtoblock %}

{% addtoblock "css" %}
<style>
#cascadeelement_id-{{ instance.pk }} {
	width: {{ instance.glossary.map_width }};
	height: {{ instance.glossary.map_height }};
}
</style>
{% endaddtoblock %}

{% addtoblock "js" %}
<script type="text/javascript">
var data = {{ instance.glossary.leaflet|json }};
var viewMap = L.map('cascadeelement_id-{{ instance.pk }}').setView([data.lat, data.lng], data.zoom);
L.tileLayer(
	"{{ settings.tilesURL }}",
	{{ settings|json }}
).addTo(viewMap);

{% for marker in markers %}
var marker;
	{% if marker.image %}
		{% thumbnail marker.image marker.size as thumb %}
		{% thumbnail marker.image marker.size2x as thumb2x %}
var icon =  L.icon({
	iconUrl: "{{ thumb.url }}",
	iconRetinaUrl: "{{ thumb2x.url }}",
	{% if marker.anchor %}iconAnchor: {{ marker.anchor }},{% endif %}
	iconSize: {{ marker.size }}
});
marker = L.marker({{ marker.glossary.leaflet|json }}, {icon: icon});
	{% else %}
marker = L.marker({{ marker.glossary.leaflet|json }});
	{% endif %}
marker.bindTooltip("{{ marker.glossary.title }}");
marker.addTo(viewMap);
{% endfor %}
</script>
{% endaddtoblock %}

<div id="cascadeelement_id-{{ instance.pk }}"></div>
